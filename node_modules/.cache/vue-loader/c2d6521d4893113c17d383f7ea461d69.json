{"remainingRequest":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\webstormProjects\\hz-websit-admin\\src\\components\\UploadVideo\\index.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"F:\\webstormProjects\\hz-websit-admin\\src\\components\\UploadVideo\\index.vue","mtime":1630899514000},{"path":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\webstormProjects\\hz-websit-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCiR3aWR0aDogMTQ4cHg7CiRoZWlnaHQ6IDE0OHB4OwoKLnVwbG9hZC1ib3ggewogIC5hdmF0YXItdXBsb2FkZXItYm94IHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogcm93OwogICAgZmxleC13cmFwOiB3cmFwOwogICAgcGFkZGluZy1ib3R0b206IDIwcHg7CiAgICBtaW4td2lkdGg6IDM1MHB4OwogICAgLmF2YXRhci11cGxvYWRlciB7CiAgICAgIC5lbC11cGxvYWQgewogICAgICAgIHdpZHRoOiAkd2lkdGg7CiAgICAgICAgaGVpZ2h0OiAkaGVpZ2h0OwogICAgICAgIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgJjpob3ZlciB7CiAgICAgICAgICBib3JkZXItY29sb3I6ICM0MDllZmY7CiAgICAgICAgfQogICAgICAgIC5lbC1sb2FkaW5nLXNwaW5uZXIgewogICAgICAgICAgd2lkdGg6ICR3aWR0aDsKICAgICAgICAgIGhlaWdodDogJGhlaWdodDsKICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgbWFyZ2luLXRvcDogMDsKICAgICAgICAgIHRvcDogMDsKICAgICAgICAgIC5lbC1sb2FkaW5nLXRleHQgewogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIC5hdmF0YXItdXBsb2FkZXItaWNvbiB7CiAgICAgICAgZm9udC1zaXplOiAyOHB4OwogICAgICAgIGNvbG9yOiAjOGM5MzlkOwogICAgICAgIHdpZHRoOiAkd2lkdGg7CiAgICAgICAgaGVpZ2h0OiAkaGVpZ2h0OwogICAgICAgIGxpbmUtaGVpZ2h0OiAkaGVpZ2h0OwogICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgfQogICAgfQogICAgLnZpZGVvLXByZXZpZXcgewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIHBhZGRpbmctcmlnaHQ6IDIwcHg7CiAgICAgIC5hdmF0YXIgewogICAgICAgIHdpZHRoOiAkd2lkdGg7CiAgICAgICAgaGVpZ2h0OiAkaGVpZ2h0OwogICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgICAgfQogICAgICAuYXZhdGFyLXVwbG9hZGVyLXBvcHVwIHsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgdG9wOiAwOwogICAgICAgIGxlZnQ6IDA7CiAgICAgICAgei1pbmRleDogMjsKICAgICAgICB3aWR0aDogJHdpZHRoOwogICAgICAgIGhlaWdodDogJGhlaWdodDsKICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKCRjb2xvcjogIzAwMDAwMCwgJGFscGhhOiAwLjUpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBjb2xvcjogI2ZmZjsKICAgICAgICBmb250LXNpemU6IDIwcHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgIGkgewogICAgICAgICAgd2lkdGg6IDMwJTsKICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgICAgIHBhZGRpbmc6IDAgNSU7CiAgICAgICAgICBmb250LXNpemU6IDI0cHg7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAudXBsb2FkLXRpcCB7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgYm90dG9tOiAwOwogICAgICBsZWZ0OiAwOwogICAgICBmb250LXNpemU6IDEycHg7CiAgICAgIGNvbG9yOiAjNjA2MjY2OwogICAgICBtYXgtd2lkdGg6IDM1MHB4OwogICAgICBsaW5lLWhlaWdodDogMjBweDsKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwLA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/UploadVideo","sourcesContent":["<template>\n  <div class=\"upload-box\">\n    <div class=\"avatar-uploader-box\">\n      <!-- 图片预览 -->\n      <div v-for=\"(item, index) in videoList\" :key=\"index\" class=\"video-preview\">\n        <video v-if=\"item.videoLink\" :src=\"`${videoBaseUrl}${item.videoLink}`\" class=\"avatar\" @mouseover.stop=\"item.isShowPopup = true\">\n          您的浏览器不支持视频播放\n        </video>\n        <video v-else :src=\"item.url\" class=\"avatar\" @mouseover.stop=\"item.isShowPopup = true\">\n          您的浏览器不支持视频播放\n        </video>\n        <!-- 显示查看和删除的按钮弹窗 -->\n        <div\n          v-show=\"(item.videoLink || item.url) && item.isShowPopup\"\n          class=\"avatar-uploader-popup\"\n          @mouseleave=\"item.isShowPopup = false\"\n        >\n          <i class=\"el-icon-zoom-in\" @click=\"previewVideo(item)\" />\n          <i class=\"el-icon-delete\" @click=\"deleteVideo(index)\" />\n        </div>\n      </div>\n\n      <!-- 方框样式 -->\n      <el-upload\n        v-show=\"uploadShow\"\n        ref=\"avatarUploader\"\n        :action=\"actionUrl\"\n        :auto-upload=\"false\"\n        :on-change=\"handleAvatarChange\"\n        :show-file-list=\"false\"\n        class=\"avatar-uploader\"\n      >\n        <span\n          v-loading=\"loading\"\n          element-loading-background=\"rgba(0, 0, 0, 0.8)\"\n          element-loading-spinner=\"el-icon-loading\"\n          element-loading-text=\"上传中\"\n          style=\"display:block;\"\n        >\n          <i class=\"el-icon-plus avatar-uploader-icon\" />\n        </span>\n      </el-upload>\n\n      <!-- 上传提示文字样式 -->\n      <div class=\"upload-tip\">\n        <slot />\n      </div>\n    </div>\n\n    <!-- 查看大图 -->\n    <el-dialog :visible.sync=\"dialogVisible\" append-to-body center title=\"视频查看\" :before-close=\"handleClose\">\n      <video ref=\"video\" :src=\"videoSrc\" controls alt width=\"100%\">您的浏览器不支持视频播放</video>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'UploadVideo',\n  components: {},\n  props: {\n    videos: {\n      type: Array,\n      default: function() {\n        return []\n      }\n    },\n    numLimit: {\n      // 最大允许上传个数\n      type: Number,\n      default: 1\n    },\n    sizeLimit: {\n      // 最大单文件大小\n      type: Number,\n      default: 50\n    },\n    videoBaseUrl: {\n      // 已上传图片服务器路径\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      loading: false,\n      dialogVisible: false,\n      videoList: [],\n      videoSrc: '',\n      actionUrl: 'http://8.136.159.136:9095/api/common/video/upload'\n    }\n  },\n  computed: {\n    uploadShow() {\n      return this.videos.length < this.numLimit\n    }\n  },\n  watch: {\n    videos: {\n      handler() {\n        const isArray = Array.isArray(this.videos)\n        if (isArray && this.videos.length > 0) {\n          this.videos.map(item => {\n            item.isShowPopup = false\n          })\n          debugger\n          this.videoList = JSON.parse(JSON.stringify(this.videos))\n        } else {\n          this.videoList = []\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  created() {},\n  methods: {\n    // 上传之前\n    beforeAvatarUpload(file) {\n      return new Promise((resolve, reject) => {\n        if (['video/mp4', 'video/ogg', 'video/flv', 'video/avi', 'video/wmv', 'video/rmvb', 'video/mov'].indexOf(file.raw.type) == -1) {\n          // eslint-disable-next-line prefer-promise-reject-errors\n          return reject('请上传正确的视频格式!')\n        }\n\n        if (file.size / 1024 / 1024 > this.sizeLimit) {\n          // eslint-disable-next-line prefer-promise-reject-errors\n          return reject(`视频大小不能超过${this.sizeLimit}M!`)\n        }\n\n        if (this.videoList.length === this.numLimit) {\n          // eslint-disable-next-line prefer-promise-reject-errors\n          return reject(`最多上传${this.numLimit}个视频`)\n        }\n\n        resolve('符合表單規則')\n      })\n    },\n    // 上传改变\n    async handleAvatarChange(file, fileList) {\n      try {\n        await this.beforeAvatarUpload(file)\n        this.uploadImgApi(file)\n      } catch (e) {\n        this.$message.warning(JSON.stringify(e))\n      }\n    },\n    // 上传视频准备\n    uploadImgApi(data) {\n      console.log(data, 'upload**')\n      const videoSrc = URL.createObjectURL(data.raw)\n      this.videoList.push({\n        videoFile: data,\n        url: videoSrc,\n        isShowPopup: false\n      })\n      this.$emit('change', this.videoList)\n    },\n    // 预览视频\n    previewVideo(data) {\n      if (data.videoLink) {\n        this.videoSrc = `${this.videoBaseUrl}${data.videoLink}`\n      } else {\n        this.videoSrc = data.url\n      }\n      this.dialogVisible = true\n    },\n    // 删除视频\n    deleteVideo(index) {\n      this.$emit('delete', index)\n    },\n    handleClose() {\n      const video = document.getElementsByTagName('video')[1]\n      if (!video.paused) {\n        video.currentTime = 0\n        video.pause()\n      }\n      this.dialogVisible = false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n$width: 148px;\n$height: 148px;\n\n.upload-box {\n  .avatar-uploader-box {\n    position: relative;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    padding-bottom: 20px;\n    min-width: 350px;\n    .avatar-uploader {\n      .el-upload {\n        width: $width;\n        height: $height;\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        cursor: pointer;\n        position: relative;\n        overflow: hidden;\n        &:hover {\n          border-color: #409eff;\n        }\n        .el-loading-spinner {\n          width: $width;\n          height: $height;\n          position: relative;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          margin-top: 0;\n          top: 0;\n          .el-loading-text {\n            margin: 0;\n          }\n        }\n      }\n      .avatar-uploader-icon {\n        font-size: 28px;\n        color: #8c939d;\n        width: $width;\n        height: $height;\n        line-height: $height;\n        text-align: center;\n      }\n    }\n    .video-preview {\n      position: relative;\n      padding-right: 20px;\n      .avatar {\n        width: $width;\n        height: $height;\n        display: block;\n        border-radius: 6px;\n      }\n      .avatar-uploader-popup {\n        position: absolute;\n        top: 0;\n        left: 0;\n        z-index: 2;\n        width: $width;\n        height: $height;\n        background: rgba($color: #000000, $alpha: 0.5);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        color: #fff;\n        font-size: 20px;\n        border-radius: 6px;\n        i {\n          width: 30%;\n          text-align: center;\n          padding: 0 5%;\n          font-size: 24px;\n        }\n      }\n    }\n    .upload-tip {\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      font-size: 12px;\n      color: #606266;\n      max-width: 350px;\n      line-height: 20px;\n    }\n  }\n}\n</style>\n"]}]}